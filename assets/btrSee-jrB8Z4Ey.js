import"./modulepreload-polyfill-B5Qt9EMX.js";import{S as C,a as R,b as p,c as P,d as G,e as W,f as V,g as r,h as B,i as I,j as _}from"./s2-playable-CCYpOjF1.js";import{M as n}from"./mtl-colors-BFHaR8KK.js";import{S as Y}from"./s2-step-animator-Btxnf0HZ.js";import{S as o}from"./s2-lerp-anim-BiCWT6VV.js";import{S as H,t as M}from"./s2-code-4Hk3M5NT.js";import{S as O}from"./s2-anim-group-BYJUEUit.js";const z="Parcours infixe, préfixe et suffixe",q=`**kw:fonction** **fn:parcoursInfixe**(**var:n**: **type:Noeud**):
  **kw:si** **var:n**.**var:gauche** existe **kw:alors**
    **fn:parcoursInfixe**(**var:n**.**var:gauche**)
  **fn:traiter**(**var:n**)
  **kw:si** **var:n**.**var:droit** existe **kw:alors**
    **fn:parcoursInfixe**(**var:n**.**var:droit**)`,U=`**kw:fonction** **fn:parcoursPrefixe**(**var:n**: **type:Noeud**):
  **fn:traiter**(**var:n**)
  **kw:si** **var:n**.**var:gauche** existe **kw:alors**
    **fn:parcoursPrefixe**(**var:n**.**var:gauche**)
  **kw:si** **var:n**.**var:droit** existe **kw:alors**
    **fn:parcoursPrefixe**(**var:n**.**var:droit**)`,b=`**kw:fonction** **fn:parcoursSuffixe**(**var:n**: **type:Noeud**):
  **kw:si** **var:n**.**var:gauche** existe **kw:alors**
    **fn:parcoursSuffixe**(**var:n**.**var:gauche**)
  **kw:si** **var:n**.**var:droit** existe **kw:alors**
    **fn:parcoursSuffixe**(**var:n**.**var:droit**)
  **fn:traiter**(**var:n**)`;class j{scene;font;constructor(t){this.scene=t,this.font=new P(t),this.font.family.set("monospace"),this.font.size.set(20,t.getViewSpace()),this.font.relativeLineHeight.set(1.3)}setNodeDefault(t){const e=this.scene.getViewSpace(),a=t.data;a.background.fill.color.copy(n.GREY_8),a.background.stroke.color.copy(n.GREY_6),a.background.stroke.width.set(4,e),a.background.cornerRadius.set(10,e),a.text.fill.color.copy(n.WHITE),a.text.horizontalAlign.set(0),a.text.verticalAlign.set(0),a.text.font.copy(this.font),a.text.font.weight.set(700),a.padding.set(0,0,e),a.minExtents.set(.4,.35,this.scene.getWorldSpace()),a.layer.set(2)}setNodeSelected(t){const e=t.data;e.background.fill.color.copy(n.GREY_9),e.background.stroke.color.copy(n.BLUE_5),e.text.fill.color.copy(n.BLUE_2)}createSelectNodeAnim(t){const e=t.data,a=new O(this.scene);return a.addLerpProperties([e.background.fill.color,e.background.stroke.color,e.text.fill.color],300,r.inOut),this.setNodeSelected(t),a.commitLerpFinalStates(),a}setNodeExplored(t){const e=t.data;e.background.fill.color.copy(n.CYAN_7),e.background.stroke.color.copy(n.CYAN_3),e.text.fill.color.copy(n.WHITE)}createExploreNodeAnim(t){const e=t.data,a=new O(this.scene);return a.addLerpProperties([e.background.fill.color,e.background.stroke.color,e.text.fill.color],300,r.inOut),this.setNodeExplored(t),a.commitLerpFinalStates(),a}setEdgeBase(t){const e=this.scene.getViewSpace(),a=t.data;a.stroke.color.copy(n.GREY_6),a.stroke.width.set(4,e),a.stroke.lineCap.set("round"),a.startDistance.set(0,e),a.endDistance.set(10,e),a.layer.set(0)}setEdgeEmphasized(t){const e=this.scene.getViewSpace(),a=t.data;a.stroke.color.copy(n.WHITE),a.stroke.width.set(5,e),a.stroke.lineCap.set("round"),a.startDistance.set(0,e),a.endDistance.set(11,e),a.layer.set(0),t.createArrowTip().data.pathStrokeFactor.set(.3)}setEdgeSelected(t){t.data.stroke.color.copyIfUnlocked(n.BLUE_5)}createSelectEdgeAnim(t){const e=o.create(this.scene,t.data.stroke.color).setCycleDuration(300).setEasing(r.inOut);return this.setEdgeSelected(t),e.commitFinalState(),e}setEdgeExplored(t){t.data.stroke.color.copyIfUnlocked(n.GREY_7)}createExploreEdgeAnim(t){const e=o.create(this.scene,t.data.stroke.color).setCycleDuration(300).setEasing(r.inOut);return this.setEdgeExplored(t),e.commitFinalState(),e}}class K{root;style;scene;mainGroup;bTreeNodes;levelDistance=1.5;baseSep=.6;height;size;center;extents;maxNodeExtents=new p;constructor(t,e,a=new j(t)){this.scene=t,this.style=a,this.center=new p,this.extents=new p,this.bTreeNodes=[],this.mainGroup=t.addGroup(new B),this.height=0,this.size=0,this.root=this.createNodes(e),this.createNodeLines(this.root,null)}createNodes(t,e=0){const a=new $(this.scene,t.data);if(this.height=Math.max(this.height,e+1),a.node.setParent(this.mainGroup),this.style.setNodeDefault(a.node),t.left){const i=this.createNodes(t.left,e+1);a.setLeft(i)}if(t.right){const i=this.createNodes(t.right,e+1);a.setRight(i)}return this.size++,this.bTreeNodes.push(a),a}createNodeLines(t,e){t!==null&&(e&&(t.parentEdge=new I(this.scene,e.node,t.node),t.parentEmphEdge=new I(this.scene,e.node,t.node),t.parentEdge.setParent(this.mainGroup),t.parentEmphEdge.setParent(this.mainGroup),this.style.setEdgeBase(t.parentEdge),this.style.setEdgeEmphasized(t.parentEmphEdge)),this.createNodeLines(t.left,t),this.createNodeLines(t.right,t))}getExtents(){return this.extents}computeExtents(){const t=this.scene.getWorldSpace();this.extents.x=(this.size-1)*this.baseSep,this.extents.y=(this.height-1)*this.levelDistance,this.extents.scale(.5),this.maxNodeExtents.set(0,0);for(const e of this.bTreeNodes){const a=e.node.getExtents(t);this.maxNodeExtents.maxV(a)}return this.extents.addV(this.maxNodeExtents),this.extents}computeLayout(t){this.center.copy(t),this.computeExtents(),this.computeLayoutRec(this.root,0,0)}computeLayoutRec(t,e,a){return t===null||(e=this.computeLayoutRec(t.left,e,a+1),t.node.data.position.set(this.center.x-this.extents.x+this.maxNodeExtents.x+e*this.baseSep,this.center.y+this.extents.y-this.maxNodeExtents.y-a*this.levelDistance,this.scene.getWorldSpace()),e++,e=this.computeLayoutRec(t.right,e,a+1)),e}animateSelectNode(t,e){if(e.parentEmphEdge){e.parentEmphEdge.data.pathTo.set(0);const i=o.create(this.scene,e.parentEmphEdge.data.pathTo).setCycleDuration(500).setEasing(r.inOut);e.parentEmphEdge.data.pathTo.set(1),t.addAnimation(i.commitFinalState())}let a=null;a=this.style.createSelectNodeAnim(e.node),e.parentEmphEdge?t.addAnimation(a,"previous-start",e.parentEdge?100:0):t.addAnimation(a,"timeline-end",e.parentEdge?100:0),e.left&&e.left.parentEdge&&(a=this.style.createSelectEdgeAnim(e.left.parentEdge),t.addAnimation(a,"previous-start",0)),e.right&&e.right.parentEdge&&(a=this.style.createSelectEdgeAnim(e.right.parentEdge),t.addAnimation(a,"previous-start",0))}animateExploreNode(t,e){const a=this.style.createExploreNodeAnim(e.node);t.addAnimation(a,"timeline-end",0)}animateExitParentEdge(t,e){if(!e.parentEdge||!e.parentEmphEdge)return;const a=o.create(this.scene,e.parentEmphEdge.data.pathTo).setCycleDuration(500).setEasing(r.inOut);e.parentEmphEdge.data.pathTo.set(0),t.addAnimation(a.commitFinalState(),"timeline-end",0);const i=this.style.createExploreEdgeAnim(e.parentEdge);t.addAnimation(i,"previous-start",200)}}class ${data;parent=null;left=null;right=null;node;parentEdge=null;parentEmphEdge=null;constructor(t,e=0){this.data=e,this.node=new _(t),this.node.setParent(t.getSVG()),this.node.setContent(e.toString())}setLeft(t){this.left=t,t.parent=this}setRight(t){this.right=t,t.parent=this}}class E extends R{tree;animator;codeStack=[];codeNW=new p(-8,4);codePositions=[];outputText;outputBackground;outputTitle;setDefaultFont(t){t.family.set("monospace"),t.size.set(16,this.getViewSpace()),t.relativeLineHeight.set(1.3)}setCodeStyle(t){const e=this.getWorldSpace(),a=this.getViewSpace(),i=new P(this);i.family.set("monospace"),i.size.set(16,a),i.relativeLineHeight.set(1.3),this.setDefaultFont(t.data.text.font),t.data.text.fill.color.copy(n.WHITE),t.data.padding.set(20,10,a),t.data.minExtents.set(3.5,1,e),t.data.background.fill.color.copy(n.GREY_9),t.data.background.stroke.color.copy(n.GREY_7),t.data.background.stroke.width.set(2,a),t.data.background.cornerRadius.set(10,a),t.data.currentLine.opacity.set(1),t.data.currentLine.fill.color.copy(n.BLACK),t.data.currentLine.fill.opacity.set(.5),t.data.currentLine.stroke.color.copy(n.WHITE),t.data.currentLine.stroke.width.set(1,a),t.data.currentLine.stroke.opacity.set(.2),t.data.currentLine.padding.set(-.5,2,a),t.data.currentLine.index.set(0)}setOutputTextStyle(t){this.setDefaultFont(t.data.font),t.data.fill.color.copy(n.WHITE),t.data.textAnchor.set(-1)}setOutputBackgroundStyle(t){const e=t.data;e.fill.color.copy(n.GREY_9),e.stroke.color.copy(n.GREY_7),e.stroke.width.set(2,this.getViewSpace()),e.cornerRadius.set(10,this.getViewSpace())}constructor(t,e,a){super(t),this.camera.setExtents(9,4.5),this.setViewportSize(720*1.5,360*1.5),this.animator=new Y(this);const i=this.getWorldSpace();this.addFillRect().data.color.copy(G.lerp(n.GREY_8,n.GREY_9,.7)),this.outputBackground=this.addRect(),this.outputTitle=new W(this),this.outputTitle.setParent(this.getSVG()),this.outputTitle.setContent("Noeuds explorés :"),this.outputTitle.data.fill.color.copyIfUnlocked(n.ORANGE_2),this.outputTitle.data.textAnchor.set(-1),this.setDefaultFont(this.outputTitle.data.font),this.outputText=new V(this),this.outputText.setParent(this.getSVG()),this.setOutputTextStyle(this.outputText),this.setOutputBackgroundStyle(this.outputBackground),this.update(),this.tree=new K(this,e);let c="";switch(a){case"in-order":c=q;break;case"pre-order":c=U;break;case"post-order":c=b;break}for(let l=0;l<this.tree.height;l++){const h=new H(this);h.setParent(this.getSVG()),this.codeStack.push(h),this.setCodeStyle(h),h.setContent(M(c)),h.data.anchor.set(-1,-1)}this.update(),this.tree.computeExtents();const u=this.tree.getExtents(),y=this.codeStack[0].getExtents(i),v=2*u.x+2*y.x+1.5,F=2*Math.max(u.y,y.y),D=new p(v/2-u.x,0),x=new p(-v/2,F/2);this.tree.computeLayout(D);for(let l=0;l<this.codeStack.length;l++){const h=new p(x.x+.2*l,x.y-.2*l);this.codePositions.push(h),this.codeStack[l].data.position.setV(h,i)}const g=this.viewSpace.convertLength(20,i),w=this.viewSpace.convertLength(21,i),L=this.viewSpace.convertLength(16,i),A=2*w+1*g,f=new p(x.x,-x.y+A);switch(this.outputBackground.data.position.setV(f,i),this.outputBackground.data.extents.set(3.5,A/2,i),this.outputBackground.data.anchor.set(-1,-1),this.outputTitle.data.position.set(f.x+g,f.y-L-.5*g,i),this.outputText.data.position.set(f.x+g,f.y-L-w-.5*g,i),this.update(),a){case"in-order":this.createInOrderAnimation(this.tree.root);break;case"pre-order":this.createPreOrderAnimation(this.tree.root);break;case"post-order":this.createPostOrderAnimation(this.tree.root);break}this.update()}animateCodeFadeIn(t){if(t<0||t>=this.codeStack.length)return;const e=this.codeStack[t];if(e.data.currentLine.index.set(0),t===0)return;const a=this.codePositions[t];e.data.currentLine.index.set(0),e.data.opacity.set(0),e.data.position.set(a.x+.5,a.y,this.getWorldSpace());const i=o.create(this,e.data.position),s=o.create(this,e.data.opacity),c=o.create(this,e.data.currentLine.index);e.data.currentLine.index.set(0),e.data.opacity.set(1),e.data.position.setV(a,this.getWorldSpace());for(const u of[i,s,c])u.setCycleDuration(500).setEasing(r.out).commitFinalState();this.animator.enableElement(e,!0),this.animator.addAnimation(i,"timeline-end",0),this.animator.addAnimation(s,"previous-start",0),this.animator.addAnimation(c,"previous-start",0)}animateCodeFadeOut(t){if(t<0||t>=this.codeStack.length)return;const e=this.codeStack[t];if(e.data.currentLine.index.set(0),t===0)return;const a=o.create(this,e.data.position),i=o.create(this,e.data.opacity),s=this.codePositions[t];e.data.opacity.set(0),e.data.position.set(s.x+.5,s.y,this.getWorldSpace());for(const c of[a,i])c.setCycleDuration(500).setEasing(r.out).commitFinalState();this.animator.addAnimation(a,"timeline-end",0),this.animator.addAnimation(i,"previous-start",0),this.animator.enableElement(e,!1)}animateCodeLineIndex(t,e){if(t<0||t>=this.codeStack.length)return;const a=this.codeStack[t],i=o.create(this,a.data.currentLine.index).setCycleDuration(500).setEasing(r.inOut);a.data.currentLine.index.set(e),this.animator.addAnimation(i.commitFinalState(),"timeline-end",0)}animateWriteOutput(t){if(this.outputText.getTSpanCount()>0){const i=this.outputText.getTSpan(this.outputText.getTSpanCount()-1),s=o.create(this,i.data.fill.color).setCycleDuration(500).setEasing(r.inOut);i.data.fill.color.copy(n.GREY_4),this.animator.addAnimation(s.commitFinalState(),"previous-start",0)}const e=this.outputText.addTSpan(t);e.data.opacity.set(0),e.data.fill.color.copy(n.WHITE),e.data.fill.color.lock();const a=o.create(this,e.data.opacity).setCycleDuration(500).setEasing(r.inOut);e.data.opacity.set(1),this.animator.addAnimation(a.commitFinalState(),"previous-start",200)}createInOrderAnimation(t,e=0){t&&(this.tree.animateSelectNode(this.animator,t),this.animateCodeFadeIn(e),this.animator.makeStep(),this.animateCodeLineIndex(e,1),this.animator.makeStep(),t.left&&(this.animateCodeLineIndex(e,2),this.animator.makeStep(),this.createInOrderAnimation(t.left,e+1)),this.animateCodeLineIndex(e,3),this.animator.makeStep(),this.tree.animateExploreNode(this.animator,t),this.animateWriteOutput(t.data.toString()+", "),this.animator.makeStep(),this.animateCodeLineIndex(e,4),this.animator.makeStep(),t.right&&(this.animateCodeLineIndex(e,5),this.animator.makeStep(),this.createInOrderAnimation(t.right,e+1)),this.tree.animateExitParentEdge(this.animator,t),this.animateCodeFadeOut(e),this.animator.makeStep())}createPreOrderAnimation(t,e=0){t&&(this.tree.animateSelectNode(this.animator,t),this.animateCodeFadeIn(e),this.animator.makeStep(),this.animator.makeStep(),this.animateCodeLineIndex(e,1),this.animator.makeStep(),this.tree.animateExploreNode(this.animator,t),this.animateWriteOutput(t.data.toString()+", "),this.animator.makeStep(),this.animateCodeLineIndex(e,2),this.animator.makeStep(),t.left&&(this.animateCodeLineIndex(e,3),this.animator.makeStep(),this.createPreOrderAnimation(t.left,e+1)),this.animateCodeLineIndex(e,4),this.animator.makeStep(),t.right&&(this.animateCodeLineIndex(e,5),this.animator.makeStep(),this.createPreOrderAnimation(t.right,e+1)),this.tree.animateExitParentEdge(this.animator,t),this.animateCodeFadeOut(e),this.animator.makeStep())}createPostOrderAnimation(t,e=0){t&&(this.tree.animateSelectNode(this.animator,t),this.animateCodeFadeIn(e),this.animator.makeStep(),this.animator.makeStep(),this.animateCodeLineIndex(e,1),this.animator.makeStep(),t.left&&(this.animateCodeLineIndex(e,2),this.animator.makeStep(),this.createPostOrderAnimation(t.left,e+1)),this.animateCodeLineIndex(e,3),this.animator.makeStep(),t.right&&(this.animateCodeLineIndex(e,4),this.animator.makeStep(),this.createPostOrderAnimation(t.right,e+1)),this.animateCodeLineIndex(e,5),this.animator.makeStep(),this.tree.animateExploreNode(this.animator,t),this.animateWriteOutput(t.data.toString()+", "),this.animator.makeStep(),this.tree.animateExitParentEdge(this.animator,t),this.animateCodeFadeOut(e),this.animator.makeStep())}}const k=document.querySelector("#app");k&&(k.innerHTML=`
        <div>
            <h1>${z}</h1>
            <svg xmlns="http://www.w3.org/2000/svg" id="test-svg" class="responsive-svg" preserveAspectRatio="xMidYMid meet"></svg>
            <div class="figure-nav">
                <div>Animation : <input type="range" id="slider" min="0" max="100" step="1" value="0" style="width:50%"></div>
                <select id="order-select">
                    <option value="pre-order">Préfixe</option>
                    <option value="in-order">Infixe</option>
                    <option value="post-order">Suffixe</option>
                </select>
                <button id="reset-button"><i class="fa-solid fa-backward-fast"></i></button>
                <button id="prev-button"><i class="fa-solid fa-step-backward"></i></button>
                <button id="play-button"><i class="fa-solid fa-redo"></i></button>
                <button id="next-button"><i class="fa-solid fa-step-forward"></i></button>
                <button id="full-button"><i class="fa-solid fa-play"></i></button>
            </div>
        </div>`);const S=k?.querySelector("#test-svg"),m=document.querySelector("#slider");if(S&&m){const d={data:0,left:{data:1,left:{data:3,right:{data:7}},right:{data:4,left:{data:8}}},right:{data:2,left:{data:5,left:{data:9},right:{data:10}},right:{data:6,left:{data:11}}}};let t=new E(S,d,"pre-order"),e=-1;t.animator.reset(),document.querySelector("#reset-button")?.addEventListener("click",()=>{e=-1,t.animator.stop(),t.animator.reset(),m.value="0"}),document.querySelector("#prev-button")?.addEventListener("click",()=>{e=C.clamp(e-1,0,t.animator.getStepCount()-1),t.animator.resetStep(e),t.update();const s=t.animator.getStepStartTime(e)/t.animator.getMasterDuration();m.value=(s*100).toString()}),document.querySelector("#next-button")?.addEventListener("click",()=>{e=C.clamp(e+1,0,t.animator.getStepCount()-1),t.animator.playStep(e);const s=t.animator.getStepStartTime(e)/t.animator.getMasterDuration();m.value=(s*100).toString()}),document.querySelector("#play-button")?.addEventListener("click",()=>{t.animator.playStep(e)}),document.querySelector("#full-button")?.addEventListener("click",()=>{t.animator.playMaster(),m.value="0"}),m.addEventListener("input",()=>{const s=m.valueAsNumber/100*t.animator.getMasterDuration();t.animator.stop(),t.animator.setMasterElapsed(s),e=t.animator.getStepIndexFromElapsed(s),t.getSVG().update()}),document.getElementById("order-select").addEventListener("change",i=>{const s=i.target;switch(t.animator.stop(),s.value){case"in-order":t=new E(S,d,"in-order");break;case"pre-order":t=new E(S,d,"pre-order");break;case"post-order":default:t=new E(S,d,"post-order");break}e=-1,t.animator.stop(),t.animator.reset()})}
