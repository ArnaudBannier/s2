import"./modulepreload-polyfill-B5Qt9EMX.js";import{p as L,l as A,m as $,S as g,a as q,c as D,e as f,M as l,g as M,i as b,j as F,C as E,b as V}from"./s2-lerp-anim-3QYG2S63.js";import{S as _,a as G}from"./s2-draggable-container-vVfXhw1I.js";class R extends L{boundA=new A(-1/0,-1/0,"world");boundB=new A(1/0,1/0,"world");space=new $("world");setOwner(t=null){this.boundA.setOwner(t),this.boundB.setOwner(t),this.space.setOwner(t)}clearDirty(){this.boundA.clearDirty(),this.boundB.clearDirty(),this.space.clearDirty()}}class I extends _{constructor(t){super(t,new R)}updatePosition(t){const e=this.data.space.get(),i=this.scene.getActiveCamera(),s=t.get(e,i),o=this.data.boundA.get(e,i),r=this.data.boundB.get(e,i),p=Math.min(o.x,r.x),m=Math.max(o.x,r.x),w=Math.min(o.y,r.y),c=Math.max(o.y,r.y);s.max(p,w),s.min(m,c),t.setV(s,e),this.clearDirty()}}class v{elements=[0,0,0,0];constructor(t=0,e=0,i=0,s=0){this.set(t,e,i,s)}set(t=0,e=0,i=0,s=0){return this.elements[0]=t,this.elements[2]=e,this.elements[1]=i,this.elements[3]=s,this}fromArray(t,e=0){for(let i=0;i<4;i++)this.elements[i]=t[i+e];return this}identity(){return this.set(1,0,0,1)}multiplyMatrices(t,e){const i=t.elements,s=e.elements,o=this.elements,r=i[0],p=i[1],m=i[2],w=i[3],c=s[0],u=s[1],d=s[2],h=s[3];return o[0]=r*c+m*u,o[2]=r*d+m*h,o[1]=p*c+w*u,o[3]=p*d+w*h,this}multiply(t){return this.multiplyMatrices(this,t)}premultiply(t){return this.multiplyMatrices(t,this)}copyFrom(t){for(let e=0;e<4;e++)this.elements[e]=t.elements[e];return this}makeScale(t,e){return this.set(t,0,0,e)}makeRotation(t){const e=Math.sin(t),i=Math.cos(t);return this.set(i,-e,e,i)}}const Y=1.5,B=new g(640,360).scale(Y),H=new q(new g(0,0),new g(6,54/16),B);class O extends D{vecU;vecV;matrix;lerpAnimU;lerpAnimV;colorAnim;playableU;playableV;playableColor;htmlEq;htmlEqMatrix;htmlFinalText;circleU;circleEigen1;circleEigen2;precision=.5;draggable;setCircleDefaultStyle(t){f.setTargets(t.data).setFillColor(l.GREY_6).setStrokeColor(l.GREY_4).setStrokeWidth(4,"view").setFillOpacity(1).setRadius(5,"view")}constructor(t,e,i,s){super(t,H),this.htmlEq=e,this.htmlEqMatrix=i,this.htmlFinalText=s;const o=this.addFillRect();f.setTargets(o.data).setColor(l.GREY_9);const r=this.addWorldGrid();r.data.geometry.space.set("world"),r.data.geometry.steps.set(1,1,"world"),r.data.geometry.referencePoint.set(.5,.5,"world"),r.data.stroke.color.copy(l.CYAN_7),r.data.stroke.width.set(1,"view"),r.data.opacity.set(.3),this.addWorldGrid().data.stroke.color.copy(l.CYAN_7);for(let a=-5;a<=5;a++){const n=new M(this);n.data.position.set(a-.1,-.25,"world"),n.data.font.size.set(12,"view"),n.data.fill.color.copy(l.GREY_2),n.data.layer.set(10),n.data.textAnchor.set("end"),n.setParent(this.getSVG()),n.setContent(a.toString())}for(let a=-3;a<=3;a++){if(a===0)continue;const n=new M(this);n.data.position.set(-.1,a-.25,"world"),n.data.font.size.set(12,"view"),n.data.fill.color.copy(l.GREY_2),n.data.layer.set(10),n.data.textAnchor.set("end"),n.setParent(this.getSVG()),n.setContent(a.toString())}this.matrix=new v(1,0,0,1),this.vecU=this.addLine(),this.vecU.data.startPosition.set(0,0,"world"),this.vecU.data.endPosition.set(0,0,"world"),this.vecU.data.stroke.color.copy(l.LIGHT_BLUE_5),this.vecU.data.stroke.width.set(6,"view"),this.vecU.data.endPadding.set(10,"view"),this.vecU.data.layer.set(1),this.vecV=this.addLine(),this.vecV.data.startPosition.set(0,0,"world"),this.vecV.data.endPosition.set(0,0,"world"),this.vecV.data.stroke.color.copy(l.RED_5),this.vecV.data.stroke.width.set(6,"view"),this.vecV.data.endPadding.set(10,"view"),this.vecV.data.layer.set(2),this.circleU=this.addCircle(),this.circleU.data.fill.color.copy(l.LIGHT_BLUE_5),this.circleU.data.radius.set(.15,"world"),this.circleU.data.opacity.set(.5),this.circleU.data.layer.set(0),this.circleEigen1=this.addCircle(),this.circleEigen2=this.addCircle();for(const a of[this.circleEigen1.data,this.circleEigen2.data])a.stroke.color.copy(l.WHITE),a.stroke.width.set(2,"view"),a.fill.opacity.set(0),a.radius.set(.15,"world");const m=this.vecU.createArrowTip();m.setAnchorAlignment(-1),m.data.layer.set(1);const w=this.vecV.createArrowTip();w.setAnchorAlignment(-1),w.data.layer.set(2);const c=this.getActiveCamera().getLower(),u=this.getActiveCamera().getUpper(),d=this.addLine();d.data.startPosition.set(c.x,0,"world"),d.data.endPosition.set(u.x-.25,0,"world"),d.data.stroke.color.copy(l.GREY_1),d.data.stroke.width.set(4,"view"),d.createArrowTip();const h=this.addLine();h.data.startPosition.set(0,c.y,"world"),h.data.endPosition.set(0,u.y-.25,"world"),h.data.stroke.color.copy(l.GREY_1),h.data.stroke.width.set(4,"view"),h.createArrowTip(),this.draggable=new G(this),this.draggable.setParent(this.getSVG()),this.draggable.data.position.copy(this.vecU.data.endPosition),this.draggable.data.radius.set(30,"view");const x=new I(this);x.data.space.set("view"),x.data.boundA.set(Math.ceil(c.x),Math.ceil(c.y),"world"),x.data.boundB.set(Math.floor(u.x),Math.floor(u.y),"world"),this.draggable.setContainer(x),this.lerpAnimU=b.create(this,this.vecU.data.endPosition),this.lerpAnimV=b.create(this,this.vecV.data.endPosition),this.colorAnim=b.create(this,this.vecV.data.stroke.color);for(const a of[this.lerpAnimU,this.lerpAnimV,this.colorAnim])a.setCycleDuration(300).setEasing(F.outExpo).commitFinalState();this.playableU=new E(this.lerpAnimU),this.playableV=new E(this.lerpAnimV),this.playableColor=new E(this.colorAnim),this.draggable.setOnDrag((a,n)=>{this.setPosition(a.getPosition("world"),"free")}),this.draggable.setOnRelease((a,n)=>{const T=this.setPosition(a.getPosition("world"),"snap");a.data.position.setV(T,"world")}),this.setMatrix(0),this.update()}setMatrix(t){switch(t){case 0:this.matrix=new v(.5,3,.75,.5),this.circleEigen1.data.position.set(2,1,"world"),this.circleEigen2.data.position.set(-2,1,"world");break;case 1:this.matrix=new v(2,1,1,2),this.circleEigen1.data.position.set(1,1,"world"),this.circleEigen2.data.position.set(1,-1,"world");break;case 2:this.matrix=new v(2,-.5,1,.5),this.circleEigen1.data.position.set(1,1,"world"),this.circleEigen2.data.position.set(1,2,"world");break;case 3:this.matrix=new v(1,0,2,-2),this.circleEigen1.data.position.set(3,2,"world"),this.circleEigen2.data.position.set(0,1,"world");break;default:this.matrix=new v(1,-1,-1,1),this.circleEigen1.data.position.set(1,1,"world"),this.circleEigen2.data.position.set(1,-1,"world")}this.setPosition(new g(1,0),"snap"),this.draggable.data.position.set(1,0,"world"),this.htmlEqMatrix.innerHTML=window.katex.renderToString(`M = \\begin{pmatrix}
            ${this.matrix.elements[0]} & ${this.matrix.elements[2]} \\\\
            ${this.matrix.elements[1]} & ${this.matrix.elements[3]}
        \\end{pmatrix}`,{throwOnError:!1})}setPosition(t,e){const i=new g(V.snap(t.x,this.precision),V.snap(t.y,this.precision)),s=e==="snap"?i:t;this.lerpAnimU.commitInitialState(),this.vecU.data.endPosition.setV(s,"world"),this.lerpAnimU.commitFinalState(),this.playableU.play();const o=s.clone().apply2x2(this.matrix);this.lerpAnimV.commitInitialState(),this.vecV.data.endPosition.setV(o,"world"),this.lerpAnimV.commitFinalState(),this.playableV.play(),this.circleU.data.position.setV(i,"world"),this.colorAnim.commitInitialState();const r=g.isZeroV(s)===!1&&(g.isZeroV(o)||Math.abs(s.det(o))<.01*s.length()*o.length()),p=s.length()<1e-6?0:o.length()/s.length();return r?this.vecV.data.stroke.color.copy(l.LIGHT_GREEN_5):this.vecV.data.stroke.color.copy(l.RED_5),this.colorAnim.commitFinalState(),this.playableColor.play(),this.htmlEq.innerHTML=window.katex.renderToString(`\\begin{aligned}
            u &= (${s.x.toFixed(1)}, ${s.y.toFixed(1)}) \\\\
            Mu &= (${o.x.toFixed(1)}, ${o.y.toFixed(1)})
        \\end{aligned}`,{throwOnError:!1}),this.htmlFinalText.innerHTML=r?`Le vecteur est un vecteur propre de valeur propre ${p.toFixed(1)}.`:"Le vecteur n'est pas un vecteur propre.",s}setPrecision(t){this.precision=t}}const S=document.querySelector("#app");S&&(S.innerHTML=`
        <div>
            <h1>Vecteurs propres</h1>
            <div>
            Choix de la matrice :
            <select id="matrix-select">
                <option value="0">M = [[0.5, 3], [0.75, 0.5]]</option>
                <option value="1">M = [[2, 1], [1, 2]]</option>
                <option value="2">M = [[2, -0.5], [1, 0.5]]</option>
                <option value="3">M = [[1, 0], [2, -2]]</option>
                <option value="4">M = [[1, -1], [-1, 1]]</option>
            </select>
            </div>
            <p>Vous pouvez déplacer le vecteur $u$ (en bleu) avec la souris. Le vecteur $v = Mu$ (en rouge ou vert) est calculé en fonction de la matrice $M$.<br>
            Lorsque les deux vecteurs sont colinéaires, le vecteur $u$ est un vecteur propre de la matrice $M$.</p>
            </p>
            <p>
                <span id="eq-u" style="display:inline-flex;min-width:25ch;align-items: baseline"></span>
                <span id="eq-matrix"></span>
            </p>
            <p><span id="final-text"></span></p>
            <svg xmlns="http://www.w3.org/2000/svg" id=test-svg class="responsive-svg" preserveAspectRatio="xMidYMid meet"></svg>
            <p></p>
        </div>`);const U=document.querySelector("#eq-u"),P=document.querySelector("#eq-matrix"),k=document.querySelector("#final-text"),C=S?.querySelector("#test-svg");if(C&&U&&P&&k){const y=new O(C,U,P,k);document.getElementById("matrix-select").addEventListener("change",e=>{const i=e.target;y.setMatrix(parseInt(i.value,10))})}
