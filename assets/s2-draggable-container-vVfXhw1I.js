import{x as g,F as l,l as o,S as c,G as h,k as m,H as p,m as D,y,s as w,B as a,o as P}from"./s2-lerp-anim-3QYG2S63.js";class O extends m{position=new o(0,0,"world");xEnabled=new p(!0);yEnabled=new p(!0);containerBoundA=new o(-1/0,-1/0,"world");containerBoundB=new o(1/0,1/0,"world");space=new D("world");constructor(){super(),this.pointerEvents.set("auto")}setOwner(t=null){super.setOwner(t),this.position.setOwner(t),this.xEnabled.setOwner(t),this.yEnabled.setOwner(t),this.containerBoundA.setOwner(t),this.containerBoundB.setOwner(t),this.space.setOwner(t)}clearDirty(){super.clearDirty(),this.position.clearDirty(),this.xEnabled.clearDirty(),this.yEnabled.clearDirty(),this.containerBoundA.clearDirty(),this.containerBoundB.clearDirty(),this.space.clearDirty()}}class b extends g{grabDelta=new l(0,0,"view");pointerPosition=new o(0,0,"view");pointerDelta=new l(0,0,"view");delta=new l(0,0,"view");pointerId=null;dragging=!1;userOnGrab=null;userOnDrag=null;userOnRelease=null;container=null;constructor(t,e){super(t,e)}initSVGElement(t){t.style.touchAction="none",t.style.cursor="pointer",t.role="draggable",t.addEventListener("pointerdown",this.onGrab,{passive:!1})}setContainer(t){this.container!==t&&(this.container=t,t?.setOwner(this),this.markDirty())}setOnGrab(t){this.userOnGrab=t}setOnDrag(t){this.userOnDrag=t}setOnRelease(t){this.userOnRelease=t}getPosition(t){return this.data.position.get(t,this.scene.getActiveCamera())}getDelta(t){return this.delta.get(t,this.scene.getActiveCamera())}getCenter(t){return this.data.position.get(t,this.scene.getActiveCamera())}getPointerDelta(t){return this.pointerDelta.get(t,this.scene.getActiveCamera())}getPointerPosition(t){return this.pointerPosition.get(t,this.scene.getActiveCamera())}updatePointerPosition(t,e){const i="view",s=this.scene.getActiveCamera(),n=this.pointerPosition.get(i,s);this.scene.convertDOMPointInto(t,e,this.pointerPosition);const u=this.pointerPosition.get(i,s),d=c.subV(u,n);this.pointerDelta.setValueFromSpaceV(d,i,s)}updatePositionFromPointer(){const t=this.data.position.space,e=this.scene.getActiveCamera(),i=this.data.position.get(t,e);let s=this.pointerPosition.get(t,e);s.addV(this.grabDelta.get(t,e)),this.data.position.setValueFromSpaceV(s,t,e),this.container&&(this.container.updatePosition(this.data.position),s=this.data.position.get(t,e)),this.delta.setV(s.subV(i),t)}onGrab=t=>{if(t.button!==void 0&&t.button!==0)return;t.preventDefault();const e="view",i=this.scene.getActiveCamera();this.updatePointerPosition(t.clientX,t.clientY);const s=this.data.position.get(e,i);this.grabDelta.setV(c.subV(s,this.pointerPosition.value),e),this.pointerDelta.set(0,0,e),this.delta.set(0,0,e);const n=this.getSVGElement();n.setPointerCapture(t.pointerId),n.addEventListener("pointermove",this.onDrag),n.addEventListener("pointerup",this.onRelease),this.pointerId=t.pointerId,this.dragging=!0,this.scene.getSVG().getSVGElement().style.touchAction="none",this.onGrabImpl(t),this.userOnGrab?.(this,t),h.requestUpdate(this.scene)};onDrag=t=>{!this.dragging||t.pointerId!==this.pointerId||(t.preventDefault(),this.updatePointerPosition(t.clientX,t.clientY),this.updatePositionFromPointer(),this.onDragImpl(t),this.userOnDrag?.(this,t),h.requestUpdate(this.scene))};onRelease=t=>{if(!this.dragging||t.pointerId!==this.pointerId)return;t.preventDefault();const e="view";this.delta.set(0,0,e),this.pointerDelta.set(0,0,e),this.pointerPosition.set(0,0,e),this.dragging=!1,this.pointerId=null;const i=this.getSVGElement();i.releasePointerCapture(t.pointerId),i.removeEventListener("pointermove",this.onDrag),i.removeEventListener("pointerup",this.onRelease),this.onReleaseImpl(t),this.userOnRelease?.(this,t),h.requestUpdate(this.scene)}}class S extends O{radius;constructor(){super(),this.radius=new P(1,"world")}setOwner(t=null){super.setOwner(t),this.radius.setOwner(t)}clearDirty(){super.clearDirty(),this.radius.clearDirty()}}class E extends b{element;opacity;constructor(t){super(t,new S),this.element=document.createElementNS(y,"circle"),this.opacity=new w(0),this.initSVGElement(this.element)}getRadius(t){return this.data.radius.get(t,this.scene.getActiveCamera())}getCenter(t){return this.data.position.get(t,this.scene.getActiveCamera())}getSVGElement(){return this.element}update(){this.skipUpdate()||(a.applyPointerEvents(this.data.pointerEvents,this.element,this.scene),a.applyOpacity(this.opacity,this.element,this.scene),a.applyPosition(this.data.position,this.element,this.scene,"cx","cy"),a.applyRadius(this.data.radius,this.element,this.scene),this.clearDirty())}onGrabImpl(t){}onDragImpl(t){}onReleaseImpl(t){}}class f{data;scene;dirty=!0;owner=null;constructor(t,e){this.scene=t,this.data=e,this.data.setOwner(this)}setOwner(t=null){this.owner=t}getOwner(){return this.owner}isDirty(){return this.dirty}markDirty(){this.isDirty()||(this.dirty=!0,this.owner?.markDirty())}clearDirty(){this.dirty=!1,this.data.clearDirty()}}export{f as S,E as a};
