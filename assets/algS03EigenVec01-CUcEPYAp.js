import"./modulepreload-polyfill-B5Qt9EMX.js";import{D as v,g as T,E as G,v as F,F as M,k as P,b as S,G as I,h as $,m as B,w as _,r as Y,x as D,n as H,o as W,H as N,a as z,e as A,S as U}from"./s2-playable-CCYpOjF1.js";import{M as l}from"./mtl-colors-BFHaR8KK.js";import{S as E,a as X}from"./s2-lerp-anim-BiCWT6VV.js";class Z{scene;animation;playable;constructor(t,e){this.scene=t,this.animation=e,this.playable=new v(this.animation),this.setDuration(500),this.animation.setEasing(T.outExpo)}setDuration(t){return this.animation instanceof X&&this.animation.setCycleDuration(t),this}setEasing(t){return this.animation.setEasing(t),this}}class j extends Z{point;constructor(t,e){const s=E.create(t,e);super(t,s),this.point=e}set(t=0,e=0,s){return this.animation.commitInitialState(),this.point.set(t,e,s),this.animation.commitFinalState(),this.playable.setRange(0,this.animation.getDuration()),this.playable.play(),this}setV(t,e){return this.set(t.x,t.y,e)}}class J{animatable;snapMode;scene;snapOnDrag=!1;snapOnRelease=!1;constructor(t,e){this.scene=t,this.animatable=new j(t,e),this.snapMode=new G("none")}getPoint(){return this.animatable.point}updateSnapMode(){if(!this.snapMode.isDirty())return;switch(this.snapMode.get()){case"always":this.snapOnDrag=!0,this.snapOnRelease=!0;break;case"release":this.snapOnDrag=!1,this.snapOnRelease=!0;break;default:case"none":this.snapOnDrag=!1,this.snapOnRelease=!1;break}this.snapMode.clearDirty()}onDrag(t,e){const s=this.scene.acquireVec2(),a=t.data.position.space;if(t.data.position.getInto(s,a),this.snapOnDrag){const i=this.scene.acquireVec2();t.data.snapSteps.getInto(i,a),s.snapV(i),this.scene.releaseVec2(i)}this.animatable.setV(s,a),this.scene.releaseVec2(s)}onRelease(t,e){const s=this.scene.acquireVec2(),a=t.data.position.space;if(t.data.position.getInto(s,a),this.snapOnRelease){const i=this.scene.acquireVec2();t.data.snapSteps.getInto(i,a),s.snapV(i),this.scene.releaseVec2(i)}this.animatable.setV(s,a),this.scene.releaseVec2(s)}}class K extends ${position;snapSteps;snapMode;constructor(t){super();const e=t.getWorldSpace();this.position=new P(0,0,e),this.snapSteps=new B(1,1,e),this.snapMode=new G("none"),this.pointerEvents.set("auto")}setOwner(t=null){super.setOwner(t),this.position.setOwner(t),this.snapSteps.setOwner(t),this.snapMode.setOwner(t)}clearDirty(){super.clearDirty(),this.position.clearDirty(),this.snapSteps.clearDirty(),this.snapMode.clearDirty()}}class Q extends F{grabDelta;pointerPosition;pointerDelta;delta;pointerId=null;dragging=!1;userOnGrab=null;userOnDrag=null;userOnRelease=null;container=null;attachedTargets=[];snapOnDrag=!1;snapOnRelease=!1;constructor(t,e){super(t,e);const s=t.getViewSpace();this.grabDelta=new M(0,0,s),this.pointerPosition=new P(0,0,s),this.pointerDelta=new M(0,0,s),this.delta=new M(0,0,s)}initSVGElement(t){t.style.touchAction="none",t.style.cursor="pointer",t.role="draggable",t.addEventListener("pointerdown",this.onGrab,{passive:!1})}attachTarget(t){const e=new J(this.scene,t);return this.attachedTargets.push(e),this.data.position.copy(t),e}setContainer(t){this.container!==t&&(this.container=t,t?.setOwner(this),this.markDirty())}setOnGrab(t){this.userOnGrab=t}setOnDrag(t){this.userOnDrag=t}setOnRelease(t){this.userOnRelease=t}getPositionInto(t,e){this.data.position.getInto(t,e)}getDeltaInto(t,e){this.delta.getInto(t,e)}getCenterInto(t,e){this.data.position.getInto(t,e)}getPointerDeltaInto(t,e){this.pointerDelta.getInto(t,e)}getPointerPositionInto(t,e){this.pointerPosition.getInto(t,e)}updateTargets(){for(const t of this.attachedTargets)t.updateSnapMode()}updateSnapMode(){switch(this.data.snapMode.get()){case"always":this.snapOnDrag=!0,this.snapOnRelease=!0;break;case"release":this.snapOnDrag=!1,this.snapOnRelease=!0;break;default:case"none":this.snapOnDrag=!1,this.snapOnRelease=!1;break}}updatePointerPosition(t,e){const s=this.scene.getViewSpace(),a=this.scene.acquireVec2(),i=this.scene.acquireVec2();this.pointerPosition.getInto(a,s),this.scene.convertDOMPointInto(this.pointerPosition,t,e),this.pointerPosition.getInto(i,s),this.pointerDelta.setV(i.subV(a),s),this.scene.releaseVec2(a),this.scene.releaseVec2(i)}updatePositionFromPointer(){const t=this.data.position.space,e=this.scene.acquireVec2(),s=this.scene.acquireVec2();if(this.data.position.getInto(e,t),this.pointerPosition.getInto(s,t),s.addV(this.grabDelta.get(t)),this.snapOnDrag){const a=this.scene.acquireVec2();this.data.snapSteps.getInto(a,t),s.snapV(a),this.scene.releaseVec2(a)}this.data.position.setV(s,t),this.container&&(this.container.updatePosition(this.data.position),this.data.position.getInto(s,t)),this.delta.setV(s.subV(e),t),this.scene.releaseVec2(e),this.scene.releaseVec2(s)}updatePositionOnRelease(){if(!this.snapOnRelease)return;const t=this.data.position.space,e=this.scene.acquireVec2();this.data.position.getInto(e,t);const s=this.scene.acquireVec2();this.data.snapSteps.getInto(s,t),e.snapV(s),this.data.position.setV(e,t),this.scene.releaseVec2(s),this.scene.releaseVec2(e)}onGrab=t=>{if(t.button!==void 0&&t.button!==0)return;t.preventDefault();const e=this.scene.getViewSpace(),s=this.scene.acquireVec2();this.updatePointerPosition(t.clientX,t.clientY),this.data.position.getInto(s,e),this.grabDelta.setV(S.subV(s,this.pointerPosition.value),e),this.pointerDelta.set(0,0,e),this.delta.set(0,0,e),this.scene.releaseVec2(s);const a=this.getSVGElement();a.setPointerCapture(t.pointerId),a.addEventListener("pointermove",this.onDrag),a.addEventListener("pointerup",this.onRelease),this.pointerId=t.pointerId,this.dragging=!0,this.scene.getSVG().getSVGElement().style.touchAction="none",this.onGrabImpl(t),this.userOnGrab?.(this,t),I.requestUpdate(this.scene)};onDrag=t=>{if(!(!this.dragging||t.pointerId!==this.pointerId)){t.preventDefault(),this.updatePointerPosition(t.clientX,t.clientY),this.updatePositionFromPointer();for(const e of this.attachedTargets)e.onDrag(this,t);this.onDragImpl(t),this.userOnDrag?.(this,t),I.requestUpdate(this.scene)}};onRelease=t=>{if(!this.dragging||t.pointerId!==this.pointerId)return;t.preventDefault(),this.updatePositionOnRelease();const e=this.scene.getViewSpace();this.delta.set(0,0,e),this.pointerDelta.set(0,0,e),this.pointerPosition.set(0,0,e),this.dragging=!1,this.pointerId=null;const s=this.getSVGElement();s.releasePointerCapture(t.pointerId),s.removeEventListener("pointermove",this.onDrag),s.removeEventListener("pointerup",this.onRelease);for(const a of this.attachedTargets)a.onRelease(this,t);this.onReleaseImpl(t),this.userOnRelease?.(this,t),I.requestUpdate(this.scene)}}class tt extends K{radius;constructor(t){super(t),this.radius=new H(1,t.getWorldSpace())}setOwner(t=null){super.setOwner(t),this.radius.setOwner(t)}clearDirty(){super.clearDirty(),this.radius.clearDirty()}}class et extends Q{element;opacity;constructor(t){super(t,new tt(t)),this.element=document.createElementNS(_,"circle"),this.opacity=new Y(.5),this.initSVGElement(this.element)}getRadius(t){return this.data.radius.get(t)}getCenter(t){return this.data.position.get(t)}getSVGElement(){return this.element}update(){this.skipUpdate()||(this.updateSnapMode(),this.updateTargets(),D.applyPointerEvents(this.data.pointerEvents,this.element,this.scene),D.applyOpacity(this.opacity,this.element,this.scene),D.applyPosition(this.data.position,this.element,this.scene,"cx","cy"),D.applyRadius(this.data.radius,this.element,this.scene),this.clearDirty())}onGrabImpl(t){}onDragImpl(t){}onReleaseImpl(t){}}class st{data;scene;dirty=!0;owner=null;constructor(t,e){this.scene=t,this.data=e,this.data.setOwner(this)}setOwner(t=null){this.owner=t}getOwner(){return this.owner}isDirty(){return this.dirty}markDirty(){this.isDirty()||(this.dirty=!0,this.owner?.markDirty())}clearDirty(){this.dirty=!1,this.data.clearDirty()}}class it extends W{boundA;boundB;space;constructor(t){super();const e=t.getWorldSpace();this.boundA=new P(-1/0,-1/0,e),this.boundB=new P(1/0,1/0,e),this.space=new N(e)}setOwner(t=null){this.boundA.setOwner(t),this.boundB.setOwner(t),this.space.setOwner(t)}clearDirty(){this.boundA.clearDirty(),this.boundB.clearDirty(),this.space.clearDirty()}}class at extends st{constructor(t){super(t,new it(t))}updatePosition(t){const e=this.data.space.get(),s=this.scene.acquireVec2(),a=this.scene.acquireVec2(),i=this.scene.acquireVec2();t.getInto(s,e),this.data.boundA.getInto(a,e),this.data.boundB.getInto(i,e);const n=Math.min(a.x,i.x),c=Math.max(a.x,i.x),h=Math.min(a.y,i.y),u=Math.max(a.y,i.y);s.max(n,h),s.min(c,u),t.setV(s,e),this.scene.releaseVec2(s),this.scene.releaseVec2(a),this.scene.releaseVec2(i),this.clearDirty()}}class d{elements=new Float32Array(4);constructor(t=0,e=0,s=0,a=0){this.set(t,e,s,a)}static createIdentity(){return new d(1,0,0,1)}static lerp(t,e,s){return new d().copy(t).lerp(e,s)}static equals(t,e,s=1e-4){const a=t.elements,i=e.elements;return Math.abs(a[0]-i[0])<=s&&Math.abs(a[1]-i[1])<=s&&Math.abs(a[2]-i[2])<=s&&Math.abs(a[3]-i[3])<=s}static det(t){const e=t.elements;return e[0]*e[3]-e[2]*e[1]}set(t=0,e=0,s=0,a=0){return this.elements[0]=t,this.elements[2]=e,this.elements[1]=s,this.elements[3]=a,this}lerp(t,e){const s=1-e,a=this.elements,i=t.elements;return a[0]=s*a[0]+e*i[0],a[1]=s*a[1]+e*i[1],a[2]=s*a[2]+e*i[2],a[3]=s*a[3]+e*i[3],this}fromArray(t,e=0){for(let s=0;s<4;s++)this.elements[s]=t[s+e];return this}isIdentity(t=1e-4){const e=this.elements;return Math.abs(e[0]-1)<=t&&Math.abs(e[1])<=t&&Math.abs(e[2])<=t&&Math.abs(e[3]-1)<=t}identity(){return this.set(1,0,0,1)}multiplyMatrices(t,e){const s=t.elements,a=e.elements,i=this.elements,n=s[0],c=s[1],h=s[2],u=s[3],V=a[0],b=a[1],m=a[2],g=a[3];return i[0]=n*V+h*b,i[2]=n*m+h*g,i[1]=c*V+u*b,i[3]=c*m+u*g,this}composeAfterCoefficients(t,e,s,a){const i=this.elements,n=i[0],c=i[1],h=i[2],u=i[3];return i[0]=t*n+e*c,i[1]=s*n+a*c,i[2]=t*h+e*u,i[3]=s*h+a*u,this}composeAfter(t){return this.multiplyMatrices(this,t)}composeBefore(t){return this.multiplyMatrices(t,this)}invert(){const t=this.elements,e=t[0],s=t[1],a=t[2],i=t[3],n=e*i-a*s;if(n===0)return console.warn("S2Mat2x3: .invert() can not invert matrix, determinant is 0"),this.makeIdentity();const c=1/n;return this.set(i*c,-a*c,-s*c,e*c),this}copy(t){const e=this.elements,s=t.elements;return e[0]=s[0],e[1]=s[1],e[2]=s[2],e[3]=s[3],this}clone(){return new d().copy(this)}det(){const t=this.elements;return t[0]*t[3]-t[2]*t[1]}makeIdentity(){return this.set(1,0,0,1)}makeScale(t,e){return this.set(t,0,0,e)}makeScaleV(t){return this.set(t.x,0,0,t.y)}makeRotation(t,e="rad"){e==="deg"&&(t*=Math.PI/180);const s=Math.sin(t),a=Math.cos(t);return this.set(a,-s,s,a)}scale(t,e){const s=this.elements;return s[0]*=t,s[1]*=e,s[2]*=t,s[3]*=e,this}rotate(t,e="rad"){e==="deg"&&(t*=Math.PI/180);const s=Math.sin(t),a=Math.cos(t);return this.composeAfterCoefficients(a,-s,+s,a)}}class nt extends z{vecU;vecV;matrix;lerpAnimU;lerpAnimV;colorAnim;playableU;playableV;playableColor;htmlEq;htmlEqMatrix;htmlFinalText;circleU;circleEigen1;circleEigen2;precision=.5;draggable;constructor(t,e,s,a){super(t),this.htmlEq=e,this.htmlEqMatrix=s,this.htmlFinalText=a,this.camera.setExtents(6,6/(16/9)),this.setViewportSize(640*1.5,360*1.5);const i=this.getWorldSpace(),n=this.getViewSpace();this.addFillRect().data.color.copy(l.BLUE_GREY_9);const h=this.addWorldGrid();h.data.geometry.space.set(i),h.data.geometry.steps.set(1,1,i),h.data.geometry.referencePoint.set(.5,.5,i),h.data.stroke.color.copy(l.CYAN_7),h.data.stroke.width.set(1,n),h.data.opacity.set(.3),this.addWorldGrid().data.stroke.color.copy(l.CYAN_7);for(let o=-5;o<=5;o++){const r=new A(this);r.data.position.set(o-.1,-.25,i),r.data.font.size.set(12,n),r.data.fill.color.copy(l.BLUE_GREY_2),r.data.layer.set(10),r.data.textAnchor.set(1),r.setParent(this.getSVG()),r.setContent(o.toString())}for(let o=-3;o<=3;o++){if(o===0)continue;const r=new A(this);r.data.position.set(-.1,o-.25,i),r.data.font.size.set(12,n),r.data.fill.color.copy(l.BLUE_GREY_2),r.data.layer.set(10),r.data.textAnchor.set(1),r.setParent(this.getSVG()),r.setContent(o.toString())}this.matrix=new d(1,0,0,1),this.vecU=this.addLine(),this.vecU.data.startPosition.set(0,0,i),this.vecU.data.endPosition.set(0,0,i),this.vecU.data.stroke.color.copy(l.LIGHT_BLUE_5),this.vecU.data.stroke.width.set(6,n),this.vecU.data.endPadding.set(10,n),this.vecU.data.layer.set(1),this.vecV=this.addLine(),this.vecV.data.startPosition.set(0,0,i),this.vecV.data.endPosition.set(0,0,i),this.vecV.data.stroke.color.copy(l.RED_5),this.vecV.data.stroke.width.set(6,n),this.vecV.data.endPadding.set(10,n),this.vecV.data.layer.set(2),this.circleU=this.addCircle(),this.circleU.data.fill.color.copy(l.LIGHT_BLUE_5),this.circleU.data.radius.set(.15,i),this.circleU.data.opacity.set(.5),this.circleU.data.layer.set(0),this.circleEigen1=this.addCircle(),this.circleEigen2=this.addCircle();for(const o of[this.circleEigen1.data,this.circleEigen2.data])o.stroke.color.copy(l.WHITE),o.stroke.width.set(2,n),o.fill.opacity.set(0),o.radius.set(.15,i);const V=this.vecU.createArrowTip();V.setAnchorAlignment(-1),V.data.layer.set(1);const b=this.vecV.createArrowTip();b.setAnchorAlignment(-1),b.data.layer.set(2);const m=this.getCamera().getLower(),g=this.getCamera().getUpper(),w=this.addLine();w.data.startPosition.set(m.x,0,i),w.data.endPosition.set(g.x-.25,0,i),w.data.stroke.color.copy(l.GREY_1),w.data.stroke.width.set(4,n),w.createArrowTip();const f=this.addLine();f.data.startPosition.set(0,m.y,i),f.data.endPosition.set(0,g.y-.25,i),f.data.stroke.color.copy(l.GREY_1),f.data.stroke.width.set(4,n),f.createArrowTip(),this.draggable=new et(this),this.draggable.setParent(this.getSVG()),this.draggable.data.position.copy(this.vecU.data.endPosition),this.draggable.data.radius.set(30,n);const x=new at(this);x.data.space.set(n),x.data.boundA.set(Math.ceil(m.x),Math.ceil(m.y),i),x.data.boundB.set(Math.floor(g.x),Math.floor(g.y),i),this.draggable.setContainer(x),this.lerpAnimU=E.create(this,this.vecU.data.endPosition),this.lerpAnimV=E.create(this,this.vecV.data.endPosition),this.colorAnim=E.create(this,this.vecV.data.stroke.color);for(const o of[this.lerpAnimU,this.lerpAnimV,this.colorAnim])o.setCycleDuration(300).setEasing(T.outExpo).commitFinalState();this.playableU=new v(this.lerpAnimU),this.playableV=new v(this.lerpAnimV),this.playableColor=new v(this.colorAnim),this.draggable.setOnDrag((o,r)=>{const y=this.acquireVec2();o.data.position.getInto(y,i),this.setPosition(y,"free"),this.releaseVec2(y)}),this.draggable.setOnRelease((o,r)=>{const y=this.acquireVec2();o.data.position.getInto(y,i);const C=this.setPosition(y,"snap");o.data.position.setV(C,i),this.releaseVec2(y)}),this.setMatrix(0),this.update()}setMatrix(t){const e=this.getWorldSpace();switch(t){case 0:this.matrix=new d(.5,3,.75,.5),this.circleEigen1.data.position.set(2,1,e),this.circleEigen2.data.position.set(-2,1,e);break;case 1:this.matrix=new d(2,1,1,2),this.circleEigen1.data.position.set(1,1,e),this.circleEigen2.data.position.set(1,-1,e);break;case 2:this.matrix=new d(2,-.5,1,.5),this.circleEigen1.data.position.set(1,1,e),this.circleEigen2.data.position.set(1,2,e);break;case 3:this.matrix=new d(1,0,2,-2),this.circleEigen1.data.position.set(3,2,e),this.circleEigen2.data.position.set(0,1,e);break;default:this.matrix=new d(1,-1,-1,1),this.circleEigen1.data.position.set(1,1,e),this.circleEigen2.data.position.set(1,-1,e)}this.setPosition(new S(1,0),"snap"),this.draggable.data.position.set(1,0,e),this.htmlEqMatrix.innerHTML=window.katex.renderToString(`M = \\begin{pmatrix}
            ${this.matrix.elements[0]} & ${this.matrix.elements[2]} \\\\
            ${this.matrix.elements[1]} & ${this.matrix.elements[3]}
        \\end{pmatrix}`,{throwOnError:!1})}setPosition(t,e){const s=this.getWorldSpace(),a=new S(U.snap(t.x,this.precision),U.snap(t.y,this.precision)),i=e==="snap"?a:t;this.lerpAnimU.commitInitialState(),this.vecU.data.endPosition.setV(i,s),this.lerpAnimU.commitFinalState(),this.playableU.play();const n=i.clone().apply2x2(this.matrix);this.lerpAnimV.commitInitialState(),this.vecV.data.endPosition.setV(n,s),this.lerpAnimV.commitFinalState(),this.playableV.play(),this.circleU.data.position.setV(a,s),this.colorAnim.commitInitialState();const c=S.isZeroV(i)===!1&&(S.isZeroV(n)||Math.abs(i.det(n))<.01*i.length()*n.length());if(c?this.vecV.data.stroke.color.copy(l.LIGHT_GREEN_5):this.vecV.data.stroke.color.copy(l.RED_5),this.colorAnim.commitFinalState(),this.playableColor.play(),e==="snap"){if(this.htmlEq.innerHTML=window.katex.renderToString(`\\begin{aligned}
            u &= (${i.x.toFixed(1)}, ${i.y.toFixed(1)}) \\\\
            Mu &= (${n.x.toFixed(1)}, ${n.y.toFixed(1)})
        \\end{aligned}`,{throwOnError:!1}),S.isZeroV(i))return this.htmlFinalText.innerHTML="Le vecteur nul n'est pas un vecteur propre par définition.",i;{const h=Math.abs(i.x)>1e-6?n.x/i.x:n.y/i.y;this.htmlFinalText.innerHTML=c?`Le vecteur est un vecteur propre de valeur propre ${h.toFixed(1)}.`:"Le vecteur n'est pas un vecteur propre."}}return i}setPrecision(t){this.precision=t}}const O=document.querySelector("#app");O&&(O.innerHTML=`
        <div>
            <h1>Vecteurs propres</h1>
            <div>
            Choix de la matrice :
            <select id="matrix-select">
                <option value="0">M = [[0.5, 3], [0.75, 0.5]]</option>
                <option value="1">M = [[2, 1], [1, 2]]</option>
                <option value="2">M = [[2, -0.5], [1, 0.5]]</option>
                <option value="3">M = [[1, 0], [2, -2]]</option>
                <option value="4">M = [[1, -1], [-1, 1]]</option>
            </select>
            </div>
            <p>Vous pouvez déplacer le vecteur $u$ (en bleu) avec la souris. Le vecteur $v = Mu$ (en rouge ou vert) est calculé en fonction de la matrice $M$.<br>
            Lorsque les deux vecteurs sont colinéaires, le vecteur $u$ est un vecteur propre de la matrice $M$.</p>
            </p>
            <p>
                <span id="eq-u" style="display:inline-flex;min-width:25ch;align-items: baseline"></span>
                <span id="eq-matrix"></span>
            </p>
            <p><span id="final-text"></span></p>
            <svg xmlns="http://www.w3.org/2000/svg" id=test-svg class="responsive-svg" preserveAspectRatio="xMidYMid meet"></svg>
            <p></p>
        </div>`);const R=document.querySelector("#eq-u"),q=document.querySelector("#eq-matrix"),k=document.querySelector("#final-text"),L=O?.querySelector("#test-svg");if(L&&R&&q&&k){const p=new nt(L,R,q,k);document.getElementById("matrix-select").addEventListener("change",e=>{const s=e.target;p.setMatrix(parseInt(s.value,10))})}
